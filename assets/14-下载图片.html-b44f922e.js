const n=JSON.parse(`{"key":"v-33c24013","path":"/code/nest-js/14-%E4%B8%8B%E8%BD%BD%E5%9B%BE%E7%89%87.html","title":"14-下载图片","lang":"zh-CN","frontmatter":{"title":"14-下载图片","updated":"2023-05-13 22:56","description":"下载文件的方式有好多种 1.download 直接下载 这个文件信息应该存数据库 我们这儿演示就写死 了 import { Controller, Post, UseInterceptors, UploadedFile, Get, Res } from '@nestjs/common'; import { UploadService } from './upload.service'; import { FileInterceptor, FilesInterceptor } from '@nestjs/platform-express' import type { Response } from 'express' import {join} from 'path' @Controller('upload') export class UploadController { constructor(private readonly uploadService: UploadService) { } @Post('album') @UseInterceptors(FileInterceptor('file')) upload(@UploadedFile() file) { console.log(file, 'file') return '峰峰35岁憋不住了' } @Get('export') downLoad(@Res() res: Response) { const url = join(__dirname,'../images/1662894316133.png') // res // console.log(url) res.download(url) // return true } }","head":[["meta",{"property":"og:url","content":"https://johno666.github.io/code/nest-js/14-%E4%B8%8B%E8%BD%BD%E5%9B%BE%E7%89%87.html"}],["meta",{"property":"og:site_name","content":"小阿俊@博客"}],["meta",{"property":"og:title","content":"14-下载图片"}],["meta",{"property":"og:description","content":"下载文件的方式有好多种 1.download 直接下载 这个文件信息应该存数据库 我们这儿演示就写死 了 import { Controller, Post, UseInterceptors, UploadedFile, Get, Res } from '@nestjs/common'; import { UploadService } from './upload.service'; import { FileInterceptor, FilesInterceptor } from '@nestjs/platform-express' import type { Response } from 'express' import {join} from 'path' @Controller('upload') export class UploadController { constructor(private readonly uploadService: UploadService) { } @Post('album') @UseInterceptors(FileInterceptor('file')) upload(@UploadedFile() file) { console.log(file, 'file') return '峰峰35岁憋不住了' } @Get('export') downLoad(@Res() res: Response) { const url = join(__dirname,'../images/1662894316133.png') // res // console.log(url) res.download(url) // return true } }"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-09-19T06:11:13.000Z"}],["meta",{"property":"article:author","content":"XiaoAjun"}],["meta",{"property":"article:modified_time","content":"2023-09-19T06:11:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"14-下载图片\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-09-19T06:11:13.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"XiaoAjun\\",\\"url\\":\\"https://johno666.github.io/\\"}]}"]]},"headers":[{"level":2,"title":"1.download 直接下载","slug":"_1-download-直接下载","link":"#_1-download-直接下载","children":[]},{"level":2,"title":"2.使用文件流的方式下载","slug":"_2-使用文件流的方式下载","link":"#_2-使用文件流的方式下载","children":[{"level":3,"title":"可以使用 compressing 把他压缩成一个 zip 包","slug":"可以使用-compressing-把他压缩成一个-zip-包","link":"#可以使用-compressing-把他压缩成一个-zip-包","children":[]},{"level":3,"title":"前端接受流，并解析","slug":"前端接受流-并解析","link":"#前端接受流-并解析","children":[]}]}],"git":{"createdTime":1695103873000,"updatedTime":1695103873000,"contributors":[{"name":"张伟竣","email":"2938795170@qq.com","commits":1}]},"readingTime":{"minutes":0.98,"words":295},"filePathRelative":"code/nest-js/14-下载图片.md","localizedDate":"2023年9月19日","excerpt":"<p>下载文件的方式有好多种</p>\\n<h2> 1.download 直接下载</h2>\\n<p>这个文件信息应该存数据库 我们这儿演示就写死 了</p>\\n<div class=\\"language-typescript line-numbers-mode\\" data-ext=\\"ts\\"><pre class=\\"language-typescript\\"><code><span class=\\"token keyword\\">import</span> <span class=\\"token punctuation\\">{</span> Controller<span class=\\"token punctuation\\">,</span> Post<span class=\\"token punctuation\\">,</span> UseInterceptors<span class=\\"token punctuation\\">,</span> UploadedFile<span class=\\"token punctuation\\">,</span> Get<span class=\\"token punctuation\\">,</span> Res <span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">from</span> <span class=\\"token string\\">'@nestjs/common'</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token punctuation\\">{</span> UploadService <span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">from</span> <span class=\\"token string\\">'./upload.service'</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token punctuation\\">{</span> FileInterceptor<span class=\\"token punctuation\\">,</span> FilesInterceptor <span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">from</span> <span class=\\"token string\\">'@nestjs/platform-express'</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token keyword\\">type</span> <span class=\\"token punctuation\\">{</span> Response <span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">from</span> <span class=\\"token string\\">'express'</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token punctuation\\">{</span>join<span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">from</span> <span class=\\"token string\\">'path'</span>\\n<span class=\\"token decorator\\"><span class=\\"token at operator\\">@</span><span class=\\"token function\\">Controller</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'upload'</span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token keyword\\">export</span> <span class=\\"token keyword\\">class</span> <span class=\\"token class-name\\">UploadController</span> <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token function\\">constructor</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">private</span> <span class=\\"token keyword\\">readonly</span> uploadService<span class=\\"token operator\\">:</span> UploadService<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span> <span class=\\"token punctuation\\">}</span>\\n  <span class=\\"token decorator\\"><span class=\\"token at operator\\">@</span><span class=\\"token function\\">Post</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'album'</span><span class=\\"token punctuation\\">)</span>\\n  <span class=\\"token decorator\\"><span class=\\"token at operator\\">@</span><span class=\\"token function\\">UseInterceptors</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token function\\">FileInterceptor</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'file'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span>\\n  <span class=\\"token function\\">upload</span><span class=\\"token punctuation\\">(</span><span class=\\"token decorator\\"><span class=\\"token at operator\\">@</span><span class=\\"token function\\">UploadedFile</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> file<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token builtin\\">console</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span>file<span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">'file'</span><span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token keyword\\">return</span> <span class=\\"token string\\">'峰峰35岁憋不住了'</span>\\n  <span class=\\"token punctuation\\">}</span>\\n  <span class=\\"token decorator\\"><span class=\\"token at operator\\">@</span><span class=\\"token function\\">Get</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'export'</span><span class=\\"token punctuation\\">)</span>\\n  <span class=\\"token function\\">downLoad</span><span class=\\"token punctuation\\">(</span><span class=\\"token decorator\\"><span class=\\"token at operator\\">@</span><span class=\\"token function\\">Res</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> res<span class=\\"token operator\\">:</span> Response<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token keyword\\">const</span> url <span class=\\"token operator\\">=</span> <span class=\\"token function\\">join</span><span class=\\"token punctuation\\">(</span>__dirname<span class=\\"token punctuation\\">,</span><span class=\\"token string\\">'../images/1662894316133.png'</span><span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token comment\\">// res</span>\\n    <span class=\\"token comment\\">// console.log(url)</span>\\n    res<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">download</span><span class=\\"token punctuation\\">(</span>url<span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token comment\\">// return  true</span>\\n  <span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","copyright":{"author":"XiaoAjun"},"autoDesc":true}`);export{n as data};
